var h=(function(){var r,c,a,o,u,n=window.PostTypeModule,d="/metronic/media/svg/files/folder-document.svg",g=function(){r=$("#types-table").DataTable({searchDelay:500,processing:!0,serverSide:!1,ajax:{url:n.routes.index,type:"GET"},columns:[{data:"name"},{data:"slug"},{data:"status"},{data:null}],columnDefs:[{targets:0,render:function(e,s,t){var i=t.name_translations&&(t.name_translations[n.locale]||t.name_translations.en)||t.name,l=t.image_url||d;return`
                            <div class="d-flex align-items-center">
                                <div class="symbol symbol-50px me-3">
                                    <img src="${l}" alt="${i}" class="rounded-2" />
                                </div>
                                <div class="d-flex flex-column">
                                    <span class="fw-bold">${i}</span>
                                </div>
                            </div>
                        `}},{targets:2,render:function(e,s,t){var i=t.status?"badge-light-success":"badge-light-danger",l=t.status_label||(t.status?"Active":"Inactive");return`<span class="badge ${i}">${l}</span>`}},{targets:-1,data:null,orderable:!1,className:"text-end",render:function(e,s,t){return`
                            <button class="btn btn-icon btn-active-light-primary w-30px h-30px me-3" data-type-action="edit" data-id="${t.id}">
                                <i class="ki-duotone ki-pencil fs-3"><span class="path1"></span><span class="path2"></span></i>
                            </button>
                            <button class="btn btn-icon btn-active-light-danger w-30px h-30px" data-type-action="delete" data-id="${t.id}">
                                <i class="ki-duotone ki-trash fs-3"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span></i>
                            </button>
                        `}}]}),r.$,$("#type-search").on("keyup",function(){r.search(this.value).draw()})},v=function(){u=FormValidation.formValidation(a,{fields:{"name[en]":{validators:{notEmpty:{message:"English name is required"}}},"name[ar]":{validators:{notEmpty:{message:"Arabic name is required"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),o.addEventListener("click",function(e){e.preventDefault(),u&&u.validate().then(function(s){if(s=="Valid"){o.setAttribute("data-kt-indicator","on"),o.disabled=!0;var t=new FormData(a),i=t.get("id"),l=i?n.routes.update.replace("__ID__",i):n.routes.store,f=i?"PUT":"POST";i&&(t.append("_method","PUT"),f="POST"),t.has("status")||t.append("status",0),axios({method:f,url:l,data:t}).then(function(m){o.removeAttribute("data-kt-indicator"),o.disabled=!1,Swal.fire({text:m.data.message,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}}).then(function(b){b.isConfirmed&&(c.hide(),r.ajax.reload())})}).catch(function(m){o.removeAttribute("data-kt-indicator"),o.disabled=!1,Swal.fire({text:m.response?.data?.message||"Sorry, looks like there are some errors detected, please try again.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})})}})})},p=function(e){var s=document.getElementById("typeImagePreview");s&&(s.style.backgroundImage="url("+(e||d)+")")},y=function(){$(document).on("click",'[data-type-action="open-form"]',function(){a.reset(),a.querySelector('[name="id"]').value="",p(d),document.getElementById("typeFormModalTitle").innerText=n.messages.create_title||"Add Post Type",c.show()}),$(document).on("click",'[data-type-action="edit"]',function(){$(this).data("id");var e=r.row($(this).closest("tr")).data();a.reset(),a.querySelector('[name="id"]').value=e.id,a.querySelector('[name="name[en]"]').value=e.name_translations?e.name_translations.en:e.name.en||"",a.querySelector('[name="name[ar]"]').value=e.name_translations?e.name_translations.ar:e.name.ar||"",a.querySelector('[name="slug"]').value=e.slug,a.querySelector('[name="status"]').checked=e.status,p(e.image_url||d),document.getElementById("typeFormModalTitle").innerText=n.messages.edit_title||"Edit Post Type",c.show()}),$(document).on("click",'[data-type-action="delete"]',function(){var e=$(this).data("id");Swal.fire({text:n.confirm.deleteMessage,icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:n.confirm.confirm,cancelButtonText:n.confirm.cancel,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(s){s.value&&axios.delete(n.routes.destroy.replace("__ID__",e)).then(function(t){Swal.fire({text:t.data.message,icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}}).then(function(){r.ajax.reload()})}).catch(function(t){Swal.fire({text:t.response?.data?.message||"Error deleting type.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}})})})})};return{init:function(){c=new bootstrap.Modal(document.querySelector("#typeFormModal")),a=document.querySelector("#typeForm"),o=document.querySelector("#typeFormSubmit"),g(),v(),y()}}})();KTUtil.onDOMContentLoaded(function(){h.init()});
